
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>WireGuard Site-to-Site VPN è¨­å®šæŒ‡å—</title>
    <style>
        body {
            font-family: "Noto Sans TC", sans-serif;
            background: #f9f9f9;
            color: #333;
            padding: 2em;
            line-height: 1.6;
            font-size: 16px;
        }
        h1, h2 { color: #1a73e8; }
        pre {
            background: #f0f0f0;
            padding: 1em;
            overflow-x: auto;
            border-left: 5px solid #1a73e8;
        }
        code { font-family: monospace; }
        .section { margin-bottom: 2em; }
    </style>
</head>
<body>
    <h1>WireGuard Site-to-Site VPN è¨­å®šæŒ‡å—ï¼ˆUDM / UCGï¼‰</h1>

    <div class="section">
        <h2>ğŸ”‘ é‡‘é‘°ç”¢ç”Ÿæ–¹å¼</h2>
        <p>åœ¨ UDM æˆ– UCG ä¸Šç”¢ç”Ÿ Private Key / Public Keyï¼š</p>
        <pre><code>wg genkey | tee privatekey | wg pubkey > publickey</code></pre>
        <ul>
            <li>Private Keyï¼š<code>cat privatekey</code></li>
            <li>Public Keyï¼š<code>cat publickey</code></li>
        </ul>
    </div>

    <div class="section">
        <h2>ğŸ› ï¸ è¨­å®šæ­¥é©Ÿ</h2>
        <p>1. SSH ç™»å…¥ UDM æˆ– UCGï¼š</p>
        <pre><code>ssh root@&lt;è¨­å‚™ IP&gt;</code></pre>

        <p>2. å»ºç«‹ <code>/etc/wireguard/wg0.conf</code> è¨­å®šæª”ï¼š</p>

        <h3>ğŸ”¹ åœ¨ UDMï¼š</h3>
        <pre><code>[Interface]
PrivateKey = &lt;UDM ç§é‘°&gt;
Address = 192.168.229.1/30
ListenPort = 51820

[Peer]
PublicKey = &lt;UCG å…¬é‘°&gt;
Endpoint = home-vpn-02.duckdns.org:51820
AllowedIPs = 192.168.2.0/24
PersistentKeepalive = 25</code></pre>

        <h3>ğŸ”¹ åœ¨ UCGï¼š</h3>
        <pre><code>[Interface]
PrivateKey = &lt;UCG ç§é‘°&gt;
Address = 192.168.229.2/30
ListenPort = 51820

[Peer]
PublicKey = &lt;UDM å…¬é‘°&gt;
Endpoint = home-vpn-01.duckdns.org:51820
AllowedIPs = 192.168.1.0/24
PersistentKeepalive = 25</code></pre>
    </div>

    <div class="section">
        <h2>ğŸš€ å•Ÿç”¨ WireGuard</h2>
        <pre><code>wg-quick up wg0</code></pre>
        <p>æª¢æŸ¥ç‹€æ…‹ï¼š</p>
        <pre><code>wg show</code></pre>
    </div>

    <div class="section">
        <h2>âš™ï¸ é–‹æ©Ÿè‡ªå‹•å•Ÿå‹• & è¨­å®šç¶­æŒ</h2>
        <p>UDM/UCG é‡é–‹æ©Ÿå¾Œæœƒé‚„åŸæª”æ¡ˆç³»çµ±ï¼Œ<strong>WireGuard è¨­å®šæª”èˆ‡åŸ·è¡Œç‹€æ…‹æœƒéºå¤±</strong>ï¼Œéœ€è¨­å®šè‡ªå‹•é‚„åŸèˆ‡å•Ÿç”¨è…³æœ¬ï¼š</p>

        <h3>1ï¸âƒ£ å®‰è£ Boostchicken çš„ udm-boot å·¥å…·</h3>
        <pre><code>curl -fsSL https://raw.githubusercontent.com/boostchicken/udm-utilities/master/on-boot-script/install.sh | sh</code></pre>

        <p>æ­¤å·¥å…·æœƒå»ºç«‹ <code>/mnt/data/on_boot.d/</code> è³‡æ–™å¤¾ã€‚</p>

        <h3>2ï¸âƒ£ å»ºç«‹è‡ªå‹•é‚„åŸèˆ‡å•Ÿç”¨è…³æœ¬</h3>
        <p>å»ºç«‹ <code>/mnt/data/on_boot.d/10-wireguard.sh</code>ï¼Œå…§å®¹å¦‚ä¸‹ï¼š</p>
        <pre><code>#!/bin/bash

# å»ºç«‹ wireguard è³‡æ–™å¤¾èˆ‡è¨­å®šæª”
mkdir -p /etc/wireguard
cp /mnt/data/wg0.conf /etc/wireguard/wg0.conf

# å•Ÿç”¨ WireGuard
wg-quick up wg0</code></pre>

        <p>å°‡æ‚¨çš„ <code>wg0.conf</code> å‚™ä»½è‡³ <code>/mnt/data/</code>ï¼š</p>
        <pre><code>cp /etc/wireguard/wg0.conf /mnt/data/wg0.conf</code></pre>

        <p>è³¦äºˆåŸ·è¡Œæ¬Šé™ï¼š</p>
        <pre><code>chmod +x /mnt/data/on_boot.d/10-wireguard.sh</code></pre>

        <p>å®Œæˆå¾Œï¼Œæ¯æ¬¡é–‹æ©Ÿæœƒè‡ªå‹•é‚„åŸä¸¦å•Ÿå‹• WireGuard è¨­å®šã€‚</p>
    </div>
</body>
</html>
